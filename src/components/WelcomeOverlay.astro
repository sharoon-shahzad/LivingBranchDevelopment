---
import logo from "../images/logo.jpg";
---

<div
  class="welcome-overlay fixed inset-x-0 bottom-0 top-20 z-40 hidden items-center justify-center bg-black/40 backdrop-blur-sm"
  role="dialog"
  aria-modal="true"
  aria-label="Welcome to Living Branch Development"
  data-welcome-overlay
>
  <div
    class="welcome-card relative mx-4 flex w-full max-w-3xl flex-col overflow-hidden rounded-3xl border border-[var(--border)] bg-white/95 shadow-2xl md:flex-row"
  >
    <button
      type="button"
      class="absolute right-4 top-4 inline-flex h-8 w-8 items-center justify-center rounded-full border border-[var(--border)] bg-white/90 text-xs font-semibold text-[var(--muted)] hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--brand-cyan)]"
      data-welcome-close
      aria-label="Close welcome message"
    >
      âœ•
    </button>

    <div class="flex-1 px-6 py-7 sm:px-8 sm:py-9 md:pr-6">
      <p class="text-xs font-semibold uppercase tracking-[0.22em] text-[var(--muted)]">
        Welcome to
      </p>
      <h2 class="mt-2 font-heading text-2xl font-semibold tracking-tight text-[color-mix(in_srgb,var(--brand-navy)_90%,black)] sm:text-3xl">
        Living Branch Development
      </h2>
      <p class="mt-4 text-sm leading-relaxed text-[color-mix(in_srgb,var(--brand-navy)_55%,var(--muted))] sm:text-base">
        Thank you for visiting our community. Here you&rsquo;ll discover how education, health care, skill
        development, and compassionate outreach come together to support families and neighbourhoods in need.
      </p>
      <p class="mt-3 text-sm leading-relaxed text-[color-mix(in_srgb,var(--brand-navy)_55%,var(--muted))] sm:text-base">
        Take a moment to explore our programmes, impact stories, and ways you can stand with us in growing
        strong, hopeful branches in every community we serve.
      </p>
    </div>

    <div class="flex flex-1 items-center justify-center bg-[color-mix(in_srgb,var(--brand-cyan)_9%,white)] px-6 py-7 sm:px-8">
      <div class="flex flex-col items-center gap-3 text-center">
        <div class="inline-flex h-28 w-28 items-center justify-center rounded-full bg-white shadow-lg sm:h-32 sm:w-32">
          <img
            src={logo.src}
            alt=""
            width="120"
            height="120"
            loading="eager"
            decoding="async"
            class="h-20 w-20 object-contain sm:h-24 sm:w-24"
          />
        </div>
        <p class="max-w-xs text-xs font-medium uppercase tracking-[0.18em] text-[color-mix(in_srgb,var(--brand-navy)_80%,black)]">
          Growing futures together
        </p>
      </div>
    </div>
  </div>

  <script>
    if (typeof window !== "undefined") {
      const overlay = document.querySelector("[data-welcome-overlay]");
      if (overlay) {
        const STORAGE_KEY = "lbd_welcome_seen";
        const showDelay = 800; // ms before showing
        const visibleDuration = 9000; // ms to stay visible (enough to read)

        // Check if user has already seen the welcome message
        const hasSeenWelcome = localStorage.getItem(STORAGE_KEY) === "true";

        const open = () => {
          overlay.classList.remove("hidden");
        };

        const close = () => {
          overlay.classList.add("hidden");
          // Mark as seen in localStorage
          localStorage.setItem(STORAGE_KEY, "true");
        };

        // Only show if user hasn't seen it before
        if (!hasSeenWelcome) {
          // Show after short delay on first load
          window.setTimeout(open, showDelay);

          // Auto-hide after duration
          window.setTimeout(close, showDelay + visibleDuration);

          const buttons = overlay.querySelectorAll("[data-welcome-close]");
          buttons.forEach((btn) => btn.addEventListener("click", close));

          window.addEventListener("keydown", (event) => {
            if (event.key === "Escape") {
              close();
            }
          });
        } else {
          // User has already seen it, keep it hidden
          overlay.classList.add("hidden");
        }
      }
    }
  </script>
</div>

