---
import logo from "../images/logo.jpg";

const nav = [
  { label: "Home", href: "/" },
  {
    label: "About",
    href: "/about",
    children: [{ label: "CEO Message", href: "/ceo-profile" }]
  },
  { label: "Our Work", href: "/our-work" },
  { label: "Get involved", href: "/get-involved" },
  { label: "Media", href: "/media" },
  { label: "Contact", href: "/contact" }
];
---

<header class="sticky top-0 z-50 border-b border-(--border) bg-white/80 backdrop-blur">
  <a
    class="sr-only focus:not-sr-only focus:absolute focus:left-4 focus:top-3 focus:z-60 rounded-md bg-white px-3 py-2 text-sm shadow"
    href="#main"
  >
    Skip to content
  </a>

  <div class="container-page flex h-20 items-center justify-between gap-4">
    <a class="flex items-center gap-3" href="/" aria-label="Living Branch Development">
      <img
        src={logo.src}
        alt=""
        width="44"
        height="44"
        loading="eager"
        decoding="async"
        class="h-12 w-12 rounded-full object-contain"
      />
      <span class="font-heading text-[1.1rem] font-semibold tracking-tight sm:text-xl">
        Living Branch Development
      </span>
    </a>

    <nav class="hidden items-center gap-7 md:flex" aria-label="Primary">
      {nav.map((item) => (
        <div class="nav-item group relative">
          <a
            class="group relative inline-flex items-center gap-2 text-[1rem] font-semibold text-(--muted) hover:text-(--fg)"
            href={item.href}
          >
            {item.label}
            {item.children ? (
              <svg viewBox="0 0 20 20" class="h-4 w-4 text-(--muted)" aria-hidden="true">
                <path fill="currentColor" d="M5.4 7.6 10 12.2l4.6-4.6 1.4 1.4L10 15 4 9l1.4-1.4Z" />
              </svg>
            ) : null}
            <span class="pointer-events-none absolute -bottom-2 left-0 h-0.75 w-full origin-left scale-x-0 rounded-full bg-(--brand-cyan) transition-transform duration-200 group-hover:scale-x-100"></span>
          </a>
          {item.children ? (
            <div class="nav-dropdown" role="menu">
              {item.children.map((child) => (
                <a class="nav-dropdown-link" href={child.href} role="menuitem">
                  {child.label}
                </a>
              ))}
            </div>
          ) : null}
        </div>
      ))}
    </nav>

    <div class="flex items-center gap-3">
      <a
        class="hidden items-center gap-2 rounded-full border border-(--border) px-5 py-2.5 text-[1rem] font-semibold text-(--fg) hover:border-transparent hover:bg-[color-mix(in_srgb,var(--brand-cyan)_12%,white)] md:inline-flex"
        href="/get-involved"
      >
        <svg viewBox="0 0 24 24" class="h-4 w-4 text-(--brand-pink)" aria-hidden="true">
          <path
            fill="currentColor"
            d="M12 21s-7.2-4.4-9.6-8.6C.8 9.3 2.6 6.4 5.8 6.1c1.8-.2 3.3.7 4.2 2 1-1.3 2.5-2.2 4.2-2 3.2.3 5 3.2 3.4 6.3C19.2 16.6 12 21 12 21Z"
          />
        </svg>
        Support a cause
      </a>

      <details class="mobile-nav md:hidden">
        <summary
          class="mobile-nav-button inline-flex cursor-pointer select-none items-center justify-center rounded-lg border border-(--border) px-3 py-2.5 text-[1rem] font-semibold text-(--fg)"
          aria-label="Open menu"
        >
          Menu
        </summary>
        <div class="mobile-nav-panel absolute left-0 right-0 mt-3 border-b border-(--border) bg-white shadow-sm">
          <div class="container-page grid gap-2 py-4">
            {nav.map((item) => (
              <div>
                <a class="rounded-md px-3 py-2 text-sm font-medium hover:bg-gray-50" href={item.href}>
                  {item.label}
                </a>
                {item.children ? (
                  <div class="mt-1 grid gap-1 pl-3">
                    {item.children.map((child) => (
                      <a class="rounded-md px-3 py-2 text-sm text-(--muted) hover:bg-gray-50" href={child.href}>
                        {child.label}
                      </a>
                    ))}
                  </div>
                ) : null}
              </div>
            ))}
            <a
              class="mt-2 inline-flex w-fit items-center gap-2 rounded-full bg-(--brand-cyan) px-4 py-2 text-sm font-semibold text-white"
              href="/get-involved"
            >
              <svg viewBox="0 0 24 24" class="h-4 w-4 text-white" aria-hidden="true">
                <path
                  fill="currentColor"
                  d="M12 21s-7.2-4.4-9.6-8.6C.8 9.3 2.6 6.4 5.8 6.1c1.8-.2 3.3.7 4.2 2 1-1.3 2.5-2.2 4.2-2 3.2.3 5 3.2 3.4 6.3C19.2 16.6 12 21 12 21Z"
                />
              </svg>
              Support a cause
            </a>
          </div>
        </div>
      </details>
    </div>
  </div>
</header>

<style>
  .mobile-nav > summary {
    list-style: none;
  }

  .mobile-nav > summary::-webkit-details-marker {
    display: none;
  }

  .mobile-nav-panel {
    opacity: 0;
    transform: translateY(-6px);
    transition: opacity 200ms ease, transform 200ms ease;
  }

  .mobile-nav[open] > .mobile-nav-panel {
    opacity: 1;
    transform: translateY(0);
  }

  .mobile-nav-button {
    position: relative;
    transition: transform 180ms ease, box-shadow 180ms ease, border-color 180ms ease;
  }

  .mobile-nav-button::after {
    content: "";
    position: absolute;
    inset: -6px;
    border-radius: 12px;
    border: 1px solid rgba(15, 107, 63, 0.35);
    opacity: 0;
    transform: scale(0.98);
    pointer-events: none;
  }

  .mobile-nav-button:active {
    transform: scale(0.98);
  }

  .mobile-nav-button:focus-visible {
    transform: translateY(-1px);
    border-color: color-mix(in srgb, var(--brand-cyan) 35%, var(--border));
    box-shadow: 0 10px 20px rgba(15, 107, 63, 0.15);
  }

  .mobile-nav[open] > .mobile-nav-button {
    transform: translateY(-1px);
    border-color: color-mix(in srgb, var(--brand-cyan) 45%, var(--border));
    box-shadow: 0 10px 20px rgba(15, 107, 63, 0.15);
  }

  .mobile-nav[open] > .mobile-nav-button::after {
    opacity: 1;
    animation: mobile-menu-pulse 1.6s ease-out infinite;
  }

  .nav-item {
    position: relative;
  }

  .nav-dropdown {
    position: absolute;
    top: calc(100% + 0.75rem);
    left: 0;
    min-width: 180px;
    padding: 0.5rem;
    border-radius: 14px;
    border: 1px solid var(--border);
    background: white;
    box-shadow: 0 18px 36px rgba(12, 16, 34, 0.12);
    opacity: 0;
    transform: translateY(-6px);
    pointer-events: none;
    transition: opacity 180ms ease, transform 180ms ease;
    z-index: 30;
  }

  .nav-dropdown::before {
    content: "";
    position: absolute;
    top: -12px;
    left: 0;
    right: 0;
    height: 12px;
  }

  .nav-item:focus-within .nav-dropdown,
  .nav-item:hover .nav-dropdown {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
  }

  .nav-dropdown-link {
    display: block;
    padding: 0.55rem 0.75rem;
    border-radius: 10px;
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--fg);
  }

  .nav-dropdown-link:hover,
  .nav-dropdown-link:focus-visible {
    background: color-mix(in srgb, var(--brand-cyan) 12%, white);
  }

  @keyframes mobile-menu-pulse {
    0% {
      transform: scale(0.96);
      opacity: 0.4;
    }
    70% {
      transform: scale(1.08);
      opacity: 0.05;
    }
    100% {
      transform: scale(1.12);
      opacity: 0;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .mobile-nav-button {
      transition: none;
    }

    .mobile-nav[open] > .mobile-nav-button::after {
      animation: none;
    }
  }
</style>

